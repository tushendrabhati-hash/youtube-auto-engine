name: YouTube Auto Upload

on:
  workflow_dispatch:

jobs:
  upload:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repo
      uses: actions/checkout@v3

    - name: Install dependencies
      run: |
        sudo apt update
        sudo apt install ffmpeg -y
        pip install google-api-python-client google-auth

    - name: Create demo video
      run: |
        ffmpeg -f lavfi -i color=c=black:s=1080x1920:d=10 \
        -vf "drawtext=text='AUTO UPLOAD WORKING':fontsize=60:fontcolor=white:x=(w-text_w)/2:y=(h-text_h)/2" \
        output.mp4

    - name: Upload to YouTube
      env:
        YT_CREDENTIALS: ${{ secrets.YT_CREDENTIALS }}
      run: python Upload.py
